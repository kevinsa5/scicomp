<!DOCTYPE html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<title>Interpreter Testbed</title>
	        <script type = "text/javascript" src = "http://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/2.7.0/math.min.js"></script>
		<script type="text/javascript" src="/global/taboverride.js"></script>
		<script type="text/javascript" src="CharacterStream.js"></script>
		<script type="text/javascript" src="TokenStream.js"></script>
		<script type="text/javascript" src="AST.js"></script>
		<script type="text/javascript" src="OutputStream.js"></script>
		<script type="text/javascript" src="Scope.js"></script>
		<script type="text/javascript" src="Interpreter.js"></script>
		<script type="text/javascript">
window.onload = function(){
tabOverride.tabSize(4);
tabOverride.autoIndent(true);
tabOverride.tabKey(9).untabKey(9, ['shift']);
var textarea = document.getElementById("code");
tabOverride.set(textarea);
}
		</script>
		<script type="text/javascript">
function tokenize(){
var out = new OutputStream();
out.setTarget($("#output"));
out.clear();
var tokenizer = new TokenStream(new CharacterStream(document.getElementById('code').value));
while(!tokenizer.empty()){
	try {
		var tok = tokenizer.next();
		out.println(tok.type + ":" + tok.value);
	} catch(e){
		console.log(e);
		out.println(e);
		return;
	}
}
}

		</script>
		<script type="text/javascript">
function parse2(){
var out = new OutputStream();
out.setTarget($("#output"));
out.clear();
var ast = new AST(new TokenStream(new CharacterStream(document.getElementById('code').value)));
try{
    var tree = ast.generate();
    out.print(JSON.stringify(tree, null, '\t'));
} catch(e){
    out.print(e);
}
}
function parse(){
var out = new OutputStream();
out.setTarget($("#output"));
out.clear();
var ast = new AST(new TokenStream(new CharacterStream(document.getElementById('code').value)));
while(!ast.empty()){
	try{
	    var exp = ast.next();
	    out.println(JSON.stringify(exp, null, '\t'));
	    out.println("~~~~~~~~~~~~~~~~~");
	} catch(e){
	    out.println(e);
	}
}
}
function run(){
var out = new OutputStream();
out.setTarget($("#output"));
out.clear();
var ast = new AST(new TokenStream(new CharacterStream(document.getElementById('code').value)));
var interp = new Interpreter(ast, out);
interp.run();
}

		</script>
	</head>
<body>
<p>Note: this may not work in Firefox &lt;45 and chromium/chrome &lt;49. </p>
<textarea id="code" cols="80" rows="20" onkeydown="if(event.keyCode===9){var v=this.value,s=this.selectionStart,e=this.selectionEnd;this.value=v.substring(0, s)+'    '+v.substring(e);this.selectionStart=this.selectionEnd=s+4;return false;}">
println("sup d00ds");

myfunc = lambda(a, b){
  if a &lt;= b then {
    println(a);
  };
  println("moss");         # critical for program functionality
  b = 6;
  if(b &gt; 5){println("butts");} else {println("toads");};
};

myfunc(1,2);

# these two lines are different!
println(2*3+4);
println(2*(3+4));

fib = lambda(n) {
        if(n &lt; 2){
                result = 1;
        } else {
                result = fib(n-1) + fib(n-2);
        };
};

print("the 11th fibonnaci number is ", fib(11));
println("");

thisvar = 0;
if(thisvar &gt; 5){
        anon = lambda(a,b) {a*b;};
} else {
        anon = lambda(a,b) {a/b;};
};
println(anon(10,2));
</textarea>
<br>
<button onclick="tokenize();">Tokenize</button>
<button onclick="parse();">Generate AST</button>
<button onclick="run();">Run Code</button>
<br>
<pre id="output" style="border:2px solid #000;max-height:200px;max-width:650px;overflow:auto;display:block;white-space:pre-wrap"></pre>
</body>
